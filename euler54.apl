p54←{
     h←{' '(≠⊆⊢)⍵}¨(⎕UCS 10)(≠⊆⊢)⍙0054_poker
     q←↓11 5⍴14 13 12 11 10 13 12 11 10 9 12 11 10 9 8 11 10 9 8 7 10 9 8 7 6 9 8 7 6 5 8 7 6 5 4 7 6 5 4 3 6 5 4 3 2 14 5 4 3 2
     r←(5⍴1)(2 1 1 1)(2 2 1)(3 1 1)⍬ ⍬(3 2)(4 1)
     R←{
         s←⌽↓⍉{⍵[⍒⌽⍵;]}{(1+'23456789TJQKA'⍳⊃⍺),≢⍵}⌸1⊃¨⍵⋄b←2⊃s
         a←{1=≢∪2⊃¨⍵:5⋄a←¯1+r⍳1⌷s⋄q∊⍨⊂b:8@{5≡⊃a}⊢4⋄a}⍵⋄a b
     }
     +/{0<⊃(⍋-⍒)(R 5↑⍵)(R 5↓⍵)}¨h
 }
